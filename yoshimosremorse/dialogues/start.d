BEGIN YYAva
BEGIN YYosh25

//initial

CHAIN IF ~Global("YYStart","GLOBAL",2)~ THEN YYAva Avatar000
@1
==BANOME25 IF ~InParty("ANOMEN") !StateCheck("ANOMEN",CD_STATE_NOTVALID)~ THEN @2
==BKELDO25 IF ~InParty("KELDORN") !StateCheck("KELDORN",CD_STATE_NOTVALID)~ THEN @3
==BVICON25 IF ~InParty("VICONIA") !StateCheck("VICONIA",CD_STATE_NOTVALID)~ THEN @4
END
IF~~THEN REPLY @5 EXTERN YYAva Avatar002
IF~~THEN REPLY @6 EXTERN YYAva Avatar001

CHAIN YYAva Avatar001
@7
EXTERN YYAva Avatar002

CHAIN YYAva Avatar002
@8
==BNALIA25 IF ~InParty("Nalia") !StateCheck("Nalia",CD_STATE_NOTVALID)~ THEN @9
==BAERIE25 IF ~InParty("Aerie") !StateCheck("Aerie",CD_STATE_NOTVALID)~ THEN @10
==BSAREV25 IF ~InParty("Sarevok") !StateCheck("Sarevok",CD_STATE_NOTVALID)~ THEN @11
END
IF~~THEN REPLY @12 EXTERN YYAva Avatar003
IF~~THEN REPLY @13 EXTERN YYAva Avatar003
IF~~THEN REPLY @14 EXTERN YYAva Avatar003

CHAIN YYAva Avatar003
@15
END
IF ~!Dead("YOSHIMO")~ DO ~SetGlobal("YYStart","GLOBAL",3) StartCutScene("YYCut2")~ EXIT
IF ~Dead("YOSHIMO")~ DO ~SetGlobal("YYStart","GLOBAL",3) StartCutScene("YYCut2a")~ EXIT

//Yoshimo appears

CHAIN IF ~Global("YYStart","GLOBAL",4)~ THEN YYosh25 Avatar004
@16
==BHAERD25 IF ~InParty("HAERDALIS") !StateCheck("HAERDALIS",CD_STATE_NOTVALID)~ THEN @17
==BANOME25 IF ~InParty("ANOMEN") !StateCheck("ANOMEN",CD_STATE_NOTVALID)~ THEN @18
==BIMOEN25 IF ~InParty("IMOEN2") !StateCheck("IMOEN2",CD_STATE_NOTVALID)~ THEN @19
==BSAREV25 IF ~InParty("Sarevok") !StateCheck("Sarevok",CD_STATE_NOTVALID)~ THEN @20
END
IF~~THEN REPLY @21 EXTERN YYosh25 Avatar006
IF~~THEN REPLY @22 EXTERN YYosh25 Avatar006
IF~~THEN REPLY @23 EXTERN YYosh25 Avatar005

CHAIN YYosh25 Avatar005
@24
EXTERN YYosh25 Avatar006

CHAIN YYosh25 Avatar006
@25
==BJAN25 IF ~InParty("JAN") !StateCheck("JAN",CD_STATE_NOTVALID)~ THEN @26
==BAERIE25 IF ~InParty("AERIE") !StateCheck("AERIE",CD_STATE_NOTVALID)~ THEN @27
==YYosh25 IF ~InParty("AERIE") !StateCheck("AERIE",CD_STATE_NOTVALID)~ THEN @28
==YYosh25 IF ~InParty("CERND") !StateCheck("CERND",CD_STATE_NOTVALID)~ THEN @29
==BCERND25 IF ~InParty("CERND") !StateCheck("CERND",CD_STATE_NOTVALID)~ THEN @30
==YYosh25 IF ~InParty("CERND") !StateCheck("CERND",CD_STATE_NOTVALID)~ THEN @31
==BEDWIN25 IF ~InParty("EDWIN") !StateCheck("EDWIN",CD_STATE_NOTVALID)~ THEN @32
==YYosh25 IF ~InParty("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ THEN @33
==BJAHEI25 IF ~InParty("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ THEN @34
==BJAHEI25 IF ~InParty("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ THEN @35
==YYosh25 IF ~InParty("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ THEN @36
==BKELDO25 IF ~InParty("KELDORN") !StateCheck("KELDORN",CD_STATE_NOTVALID)~ THEN @37
==BKORGA25 IF ~InParty("KORGAN") !StateCheck("KORGAN",CD_STATE_NOTVALID)~ THEN @38
==BMAZZY25 IF ~InParty("Mazzy") !StateCheck("Mazzy",CD_STATE_NOTVALID)~ THEN @39
==BMINSC25 IF ~InParty("Minsc") !StateCheck("Minsc",CD_STATE_NOTVALID)~ THEN @40
==BMINSC25 IF ~InParty("Minsc") !StateCheck("Minsc",CD_STATE_NOTVALID)~ THEN @41
==BMINSC25 IF ~InParty("Minsc") !StateCheck("Minsc",CD_STATE_NOTVALID)~ THEN @42
==YYosh25 IF ~InParty("Minsc") !StateCheck("Minsc",CD_STATE_NOTVALID)~ THEN @43
==BNALIA25 IF ~InParty("Nalia") !StateCheck("Nalia",CD_STATE_NOTVALID)~ THEN @44
==YYosh25 IF ~InParty("Nalia") !StateCheck("Nalia",CD_STATE_NOTVALID)~ THEN @45
==YYosh25 IF ~InParty("Nalia") !StateCheck("Nalia",CD_STATE_NOTVALID)~ THEN @46
==YYosh25 IF ~InParty("Valygar") !StateCheck("Valygar",CD_STATE_NOTVALID)~ THEN @47
==BVALYG25 IF ~InParty("Valygar") !StateCheck("Valygar",CD_STATE_NOTVALID)~ THEN @48
==BVICON25 IF ~InParty("Viconia") !StateCheck("Viconia",CD_STATE_NOTVALID)~ THEN @49
==YYosh25 IF ~InParty("Viconia") !StateCheck("Viconia",CD_STATE_NOTVALID)~ THEN @50
END
IF~~THEN REPLY @51 EXTERN YYAva Avatar003x
IF~~THEN REPLY @52 EXTERN YYAva Avatar003x
IF~~THEN REPLY @53 EXTERN YYAva Avatar003x

CHAIN YYAva Avatar003x
@54
==YYAva @55
END
IF~~THEN REPLY @56 EXTERN YYAva Avatar003xx
IF~~THEN REPLY @57 EXTERN YYAva Avatar004x

CHAIN YYAva Avatar003xx
@58
EXTERN YYAva Avatar004x

CHAIN YYAva Avatar004x
@59
EXTERN YYAva Avatar004xx

CHAIN YYAva Avatar004xx
@60
==YYosh25 @61
END
IF~~THEN REPLY @62 EXTERN YYAva Avatar007x
IF~~THEN REPLY @63 EXTERN YYAva Avatar005x

CHAIN YYAva Avatar005x
@64
END
IF~~THEN REPLY @65 EXTERN YYosh25 Avatar006xx
IF~~THEN REPLY @66 EXTERN YYAva Avatar007x

CHAIN YYosh25 Avatar006xx
@67
==YYAva @68
EXTERN YYAva Avatar007x

CHAIN YYAva Avatar007x
@69
==BANOME25 IF ~InParty("ANOMEN") !StateCheck("ANOMEN",CD_STATE_NOTVALID)~ THEN @70
==BIMOEN25 IF ~InParty("IMOEN2") !StateCheck("IMOEN2",CD_STATE_NOTVALID)~ THEN @71
END
IF~~THEN REPLY @72 EXTERN YYosh25 Avatar008
IF~~THEN REPLY @73 EXTERN YYosh25 Avatar009
IF~~THEN REPLY @74 EXTERN YYosh25 Avatar010
IF~~THEN REPLY @75 EXTERN YYAva Avatar011

CHAIN YYosh25 Avatar008
@76
== YYosh25 @77
END
IF~~THEN REPLY @78 EXTERN YYosh25 Avatar009
IF~~THEN REPLY @79 EXTERN YYosh25 Avatar010
IF~~THEN REPLY @80 EXTERN YYAva Avatar011

CHAIN YYosh25 Avatar009
@81
== YYosh25 @82
==BANOME25 IF ~InParty("ANOMEN") !StateCheck("ANOMEN",CD_STATE_NOTVALID)~ THEN @83
==BJAHEI25 IF ~InParty("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ THEN @84
==BIMOEN25 IF ~InParty("IMOEN2") !StateCheck("IMOEN2",CD_STATE_NOTVALID)~ THEN @85
==YYAva @86
==YYAva @87
DO ~SetGlobal("YYStart","GLOBAL",5) DestroySelf()~ EXIT

CHAIN YYosh25 Avatar010
@88
==YYAva @89
==YYAva @90
DO ~SetGlobal("YYStart","GLOBAL",50) ActionOverride("YOSHIMO",DestroySelf()) DestroySelf()~ EXIT

CHAIN YYAva Avatar011
@91
DO ~SetGlobal("YYStart","GLOBAL",5) DestroySelf()~ EXIT

APPEND YYosh25

//join after Messenger is left

IF~Global("YYStart","GLOBAL",5)~THEN BEGIN YoshimoToB000
SAY @92
IF~~THEN REPLY @93 GOTO YoshimoToB001
IF~~THEN REPLY @94 GOTO YoshimoToB001
IF~~THEN REPLY @95 GOTO YoshimoToB002
END

IF~Global("YYStart","GLOBAL",6)~THEN BEGIN YoshimoToBB00
SAY @96
IF~~THEN REPLY @97 GOTO YoshimoToB007
IF~~THEN REPLY @98 GOTO YoshimoToB008
IF~~THEN REPLY @99 GOTO YoshimoToB009
IF~~THEN REPLY @100 GOTO YoshimoToB010
IF~~THEN REPLY @101 GOTO YoshimoToB00E
END


IF~~THEN BEGIN YoshimoToB001
SAY @102
IF~~THEN REPLY @103 GOTO YoshimoToB003
IF~~THEN REPLY @104 GOTO YoshimoToB002
END

IF~~THEN BEGIN YoshimoToB003
SAY @105
IF~~THEN REPLY @106 GOTO YoshimoToB004
IF~~THEN REPLY @107 GOTO YoshimoToB005
IF~~THEN REPLY @108 GOTO YoshimoToB002
END

IF~~THEN BEGIN YoshimoToB004
SAY @109
IF~~THEN GOTO YoshimoToB006
END

IF~~THEN BEGIN YoshimoToB005
SAY @110
= @111
IF~~THEN GOTO YoshimoToB006
END

IF~~THEN BEGIN YoshimoToB006
SAY @112
IF~~THEN REPLY @113 GOTO YoshimoToB007
IF~~THEN REPLY @114 GOTO YoshimoToB008
IF~~THEN REPLY @115 GOTO YoshimoToB009
IF~~THEN REPLY @116 GOTO YoshimoToB010
IF~~THEN REPLY @117 GOTO YoshimoToB00E
END

IF~~THEN BEGIN YoshimoToB007
SAY @118
IF~~THEN GOTO YoshimoToB011
END

IF~~THEN BEGIN YoshimoToB008
SAY @119
= @120
IF~~THEN GOTO YoshimoToB011
END

IF~~THEN BEGIN YoshimoToB009
SAY @121
IF~~THEN GOTO YoshimoToB011
END

IF~~THEN BEGIN YoshimoToB011
SAY @122
IF~~THEN REPLY @123 GOTO YoshimoToB007
IF~~THEN REPLY @124 GOTO YoshimoToB008
IF~~THEN REPLY @125 GOTO YoshimoToB009
IF~~THEN REPLY @126 GOTO YoshimoToB010
IF~~THEN REPLY @127 GOTO YoshimoToB00E
END

IF~~THEN BEGIN YoshimoToB010
SAY @128
= @129
IF~~THEN DO ~SetGlobal("YYStart","GLOBAL",7) IncrementGlobal("YYoshimoInfuence","GLOBAL",-2) JoinParty()~ EXIT
END

IF~~THEN BEGIN YoshimoToB00E
SAY @130
IF~~THEN DO ~SetGlobal("YYStart","GLOBAL",7) IncrementGlobal("YYoshimoInfuence","GLOBAL",1) JoinParty()~ EXIT
END

IF~~THEN BEGIN YoshimoToB002
SAY @131
IF~~THEN DO ~SetGlobal("YYStart","GLOBAL",6)~ EXIT
END
END

APPEND YYAva

//Check-up on Yoshimo

IF~Global("YYAvaSecondEncounter","GLOBAL",2)~THEN BEGIN AvatarSecondEncounter
SAY @132
= @133
IF~~THEN REPLY @134 GOTO YYase1.1
IF~~THEN REPLY @135 GOTO YYase1.1
IF~~THEN REPLY @136 GOTO YYase1.1
IF~~THEN REPLY @137 GOTO YYase1.1
END 

IF~~THEN BEGIN YYase1.1
SAY @138
= @139
= @140
IF~~THEN REPLY @141 GOTO YYase1.2
IF~~THEN REPLY @142 GOTO YYase1.2
IF~~THEN REPLY @143 GOTO YYase1.1.1
IF~~THEN REPLY @144 GOTO YYase1.2
IF~~THEN REPLY @145 GOTO YYase1.2
IF~~THEN REPLY @146 GOTO YYase1.2
END

IF~~THEN BEGIN YYase1.1.1
SAY @147
= @148
IF~~THEN REPLY @149 GOTO YYase1.2
IF~~THEN REPLY @150 GOTO YYase1.2
IF~~THEN REPLY @151 GOTO YYase1.2
IF~~THEN REPLY @152 GOTO YYase1.2
IF~~THEN REPLY @153 GOTO YYase1.2
END 

IF~~THEN BEGIN YYase1.2
SAY @154
= @155
= @156
IF~~THEN DO ~SetGlobal("YYAvaSecondEncounter","GLOBAL",3)~ EXIT
END
END

BEGIN YYosh25P

IF ~Global("YYStart","GLOBAL",7)~ THEN BEGIN LeaveNoYosh00
SAY @157
IF~~THEN REPLY @158 DO ~SetGlobal("YYStart","GLOBAL",8)~ EXIT
IF~~THEN REPLY @159 DO ~SetGlobal("YYStart","GLOBAL",7) JoinParty()~ EXIT
END

IF ~Global("YYStart","GLOBAL",8)~ THEN BEGIN LeaveNoYosh00
SAY @160
IF~~THEN REPLY @161 DO ~SetGlobal("YYStart","GLOBAL",8)~ EXIT
IF~~THEN REPLY @162 DO ~SetGlobal("YYStart","GLOBAL",7) JoinParty()~ EXIT
END


